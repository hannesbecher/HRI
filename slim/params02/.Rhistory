gt2
gt2[1:2,]
gt2[1:2,] %*% c(1,2)
c(1,2) %*% gt2[1:2,]
table(c(1,2) %*% gt2[1:2,])
t(gt2[1:2,]))
t(gt2[1:2,])
rowSums(t(gt2[1:2,]))
table(rowSums(t(gt2[1:2,])))
c(1,2) %*% gt2[1:2,]
table(c(1,2) %*% gt2[1:2,])
proportions(table(c(1,2) %*% gt2[1:2,]))
c(1,2) %*% gt2[1:2,]
ldD <- function(gtRows){
sapply(0:3, function(x) sum(x == c(1,2) %*% gtRows))
}
ldD <- function(gtRows){
proportion(sapply(0:3, function(x) sum(x == c(1,2) %*% gtRows)))
}
ldD(gt2[1:2,])
ldD <- function(gtRows){
proportions(sapply(0:3, function(x) sum(x == c(1,2) %*% gtRows)))
}
ldD(gt2[1:2,])
ldD <- function(gtRows){
l <- ncol(gtRows)
xx <- proportions(sapply(0:3, function(x) sum(x == c(1,2) %*% gtRows)))
pA <- sum(gtRows[1,])/l
pB <- sum(gtRows[2,])/l
xx[3] = pA*pB
}
ldD(gt2[1:2,])
ldD <- function(gtRows){
l <- ncol(gtRows)
xx <- proportions(sapply(0:3, function(x) sum(x == c(1,2) %*% gtRows)))
pA <- sum(gtRows[1,])/l
pB <- sum(gtRows[2,])/l
xx[3] - pA*pB
}
ldD(gt2[1:2,])
ldD(gt2[1:2,])
pairwiseLD <- function(gts){
oVals <- matrix(0, nrow(gts), nrow(gts))
for(i in 2:nrow(gts)){
for(j in 1:(i-1)){
oVals[i,j] <- ldD(gts[c(i,j),])
}
}
oVals[lower.tri(oVals)]
}
pairwiseLD <- function(gts){
oVals <- matrix(0, nrow(gts), nrow(gts))
for(i in 2:nrow(gts)){
for(j in 1:(i-1)){
oVals[i,j] <- ldD(gts[c(i,j),])
}
}
oVals[lower.tri(oVals)]
}
ls2 <- pairwiseLD(gt2)
ls2
hist(ls2)
plot(ls2)
pairwiseLD <- function(gts){
oVals <- matrix(0, nrow(gts), nrow(gts))
for(i in 2:nrow(gts)){
for(j in 1:(i-1)){
oVals[i,j] <- ldD(gts[c(i,j),])
}
}
#oVals[lower.tri(oVals)]
oVals
}
ld2 <- pairwiseLD(gt2)
image(ld2)
pairwiseLD <- function(gts){
oVals <- matrix(NA, nrow(gts), nrow(gts))
for(i in 2:nrow(gts)){
for(j in 1:(i-1)){
oVals[i,j] <- ldD(gts[c(i,j),])
}
}
#oVals[lower.tri(oVals)]
oVals
}
ld2 <- pairwiseLD(gt2)
image(ld2)
hist(ls2)
plot(unlist(ls2))
image(ld2)
hist(ld2)
image(ld2)
ld2[1:10, 1:10]
ld2[1:10,]
image(ld2[1:10,])
max(ld2[1:10,])
max(ld2[1:10,], na.rm = T)
ldD(gt2[7:8,])
gt[7:8,]
gt2[7:8,]
t(pairwiseLD <- function(gts){)
t(gt2[7:8,])
t(gt2[7:8,]) %*% c(1,2)
sapply(0:3, function(x) sum(x==t(gt2[7:8,]) %*% c(1,2)))
proportions(sapply(0:3, function(x) sum(x==t(gt2[7:8,]) %*% c(1,2))))
# LD for a 2-row matrix
ldD <- function(gtRows){
l <- ncol(gtRows) # number of haploid inds
xx <- proportions(sapply(0:3, function(x) sum(x == c(1,2) %*% gtRows)))
# allele frequencies at the loci
pA <- sum(gtRows[1,])/l
pB <- sum(gtRows[2,])/l
# pAB - pA*pB
xx[4] - pA*pB
}
ldD(gt2[1:2,])
ldD(gt2[1:2,])
ldD(gt2[7:8,])
proportions(sapply(0:3, function(x) sum(x==t(gt2[7:8,]) %*% c(1,2))))
pairwiseLD <- function(gts){
oVals <- matrix(NA, nrow(gts), nrow(gts))
for(i in 2:nrow(gts)){
for(j in 1:(i-1)){
oVals[i,j] <- ldD(gts[c(i,j),])
}
}
#oVals[lower.tri(oVals)]
oVals
}
ld2 <- pairwiseLD(gt2)
image(ld2)
hist(ld2)
image(ld2[1:10,])
plot(unlist(ls2))
plot(unlist(ld2))
ld2
plot(as.vector(ld2))
hist(ld2)
image(ld2)
hist(ld2)
cor(gt2)
cor(t(gt2))
lower.tri(nrow(gt2))
?lower.tri
cor(t(gt2))[lower.tri(matrix(0,nrow(gt2),nrow(gt2))]
cor(t(gt2))[lower.tri(matrix(0,nrow(gt2),nrow(gt2)))]
cc <- as.vector(cor(t(gt2))[lower.tri(matrix(0,nrow(gt2),nrow(gt2)))])
cc2 <- as.vector(cor(t(gt2))[upper.tri(matrix(0,nrow(gt2),nrow(gt2)))])
hist(cc)
hist(cc2)
plot(cc, ld2)
cc
ld2
pairwiseLD <- function(gts){
oVals <- matrix(NA, nrow(gts), nrow(gts))
for(i in 2:nrow(gts)){
for(j in 1:(i-1)){
oVals[i,j] <- ldD(gts[c(i,j),])
}
}
oVals[lower.tri(oVals)]
}
ld2 <- pairwiseLD(gt2)
#image(ld2)
hist(ld2)
plot(cc, ld2)
pairwiasr2 <- function(gts){
as.vector(cor(t(gts))[lower.tri(matrix(0,nrow(gts),nrow(gts)))])
}
source("analyseArrays.R")
source("analyseArrays.R")
gt2 <- read.gt(x = "~/Desktop/sim000.gt2")
gt4 <- read.gt(x = "~/Desktop/sim000.gt2")
gt4 <- read.gt(x = "~/Desktop/sim000.gt4")
sampleGt <- function(gt, n){
gt[, sample(x = 1:ncol(gt), size = n, replace = F)]
}
sampleGt(gt2, 20)
dim(sampleGt(gt2, 20))
samp2 <- lapply(c(10, 20, 40, 80), function(n) sampleGt(gt2, n))
samp4 <- lapply(c(10, 20, 40, 80), function(n) sampleGt(gt4, n))
lapply(samp2, gt2sfs)
sfs4 <- lapply(samp4, gt2sfs)
sfs2 <- lapply(samp2, gt2sfs)
sfs4
sapply(sfs2, theta_pi)
sapply(sfs2, theta_pi, per_site=T)
sapply(sfs2, theta_pi, persite=T)
sapply(sfs2, theta_w, persite=T)
sapply(sfs2, tajd, persite=T)
sapply(sfs2, tajd)
sapply(sfs2, deltaTheta)
source("analyseArrays.R")
gt2 <- read.gt(x = "~/temp/HRI/sim000.gt2")
gt4 <- read.gt(x = "~/temp/HRI/sim000.gt4")
samp2 <- lapply(c(10, 20, 40, 80), function(n) sampleGt(gt2, n))
samp4 <- lapply(c(10, 20, 40, 80), function(n) sampleGt(gt4, n))
sfs2 <- lapply(samp2, gt2sfs)
sfs4 <- lapply(samp4, gt2sfs)
sfs2
sapply(sfs2, theta_pi, persite=T)
sapply(sfs2, theta_w, persite=T)
sapply(sfs2, tajd)
sapply(sfs2, deltaTheta)
source("analyseArrays.R")
pairwiseLD(gt2)
ldVec2 <- pairwiseLD(gt2)
rVec2 <- pairwiser2(gt2)
dim(gt2)
dim(gt2[apply(gt2, 1, sd) =! 0, ])
dim(gt2[apply(gt2, 1, sd) != 0, ])
292*291/2
meanN <- function(vec, n){
sum(vec)/n
}
meanN(pairwiseLD(gt2), 2500)
meanN(pairwiser2(gt2), 2500)
plot(pairwiseLD(gt2), pairwiser2(gt2))
sapply(sfs2, theta_pi, persite=T)
sapply(sfs2, theta_w, persite=T)
sapply(sfs2, tajd)
sapply(sfs2, deltaTheta)
sfs2 <- lapply(samp2, gt2sfs)
sfs4 <- lapply(samp4, gt2sfs)
sapply(sfs2, theta_pi, persite=T)
sapply(sfs2, theta_w, persite=T)
sfs2 <- lapply(samp2, gt2sfs)
sfs4 <- lapply(samp4, gt2sfs)
sapply(sfs2, theta_pi, persite=T)
sapply(sfs2, theta_w, persite=T)
sapply(sfs2, tajd)
sapply(sfs2, deltaTheta)
dataRow <- c(tp2, tw2, ta2, de2,
tp4, tw4, ta4, de4,
LDmean2, r2mean2, LDmean4, r2mean4)
tp2 <- sapply(sfs2, theta_pi, persite=T)
tw2 <- sapply(sfs2, theta_w, persite=T)
ta2 <- sapply(sfs2, tajd)
de2 <- sapply(sfs2, deltaTheta)
tp4 <- sapply(sfs4, theta_pi, persite=T)
tw4 <- sapply(sfs4, theta_w, persite=T)
ta4 <- sapply(sfs4, tajd)
de4 <- sapply(sfs4, deltaTheta)
LDmean2 <- meanN(pairwiseLD(gt2), 2500)
r2mean2 <- meanN(pairwiser2(gt2), 2500)
LDmean4 <- meanN(pairwiseLD(gt4), 2500)
r2mean4 <- meanN(pairwiser2(gt4), 2500)
dataRow <- c(tp2, tw2, ta2, de2,
tp4, tw4, ta4, de4,
LDmean2, r2mean2, LDmean4, r2mean4)
names(dataRow) <- c("tpS_10", "tpS_20", "tpS_40", "tpS_80",
"twS_10", "twS_20", "twS_40", "twS_80",
"taS_10", "taS_20", "taS_40", "taS_80",
"deS_10", "deS_20", "deS_40", "deS_80",
"tpN_10", "tpN_20", "tpN_40", "tpN_80",
"twN_10", "twN_20", "twN_40", "twN_80",
"taN_10", "taN_20", "taN_40", "taN_80",
"deN_10", "deN_20", "deN_40", "deN_80",
"LDmeanS", "r2meanS", "LDmeanN", "r2meanN")
dataRow
anaFun <- function(repID){
gt2 <- read.gt(paste0(x = "~/temp/HRI/sim"), repID, ".gt2")
gt4 <- read.gt(paste0(x = "~/temp/HRI/sim"), repID, ".gt4")
samp2 <- lapply(c(10, 20, 40, 80), function(n) sampleGt(gt2, n))
samp4 <- lapply(c(10, 20, 40, 80), function(n) sampleGt(gt4, n))
sfs2 <- lapply(samp2, gt2sfs)
sfs4 <- lapply(samp4, gt2sfs)
tp2 <- sapply(sfs2, theta_pi, persite=T)
tw2 <- sapply(sfs2, theta_w, persite=T)
ta2 <- sapply(sfs2, tajd)
de2 <- sapply(sfs2, deltaTheta)
tp4 <- sapply(sfs4, theta_pi, persite=T)
tw4 <- sapply(sfs4, theta_w, persite=T)
ta4 <- sapply(sfs4, tajd)
de4 <- sapply(sfs4, deltaTheta)
LDmean2 <- meanN(pairwiseLD(gt2), 2500)
r2mean2 <- meanN(pairwiser2(gt2), 2500)
LDmean4 <- meanN(pairwiseLD(gt4), 2500)
r2mean4 <- meanN(pairwiser2(gt4), 2500)
#plot(pairwiseLD(gt2), pairwiser2(gt2))
dataRow <- c(tp2, tw2, ta2, de2,
tp4, tw4, ta4, de4,
LDmean2, r2mean2, LDmean4, r2mean4)
names(dataRow) <- c("tpS_10", "tpS_20", "tpS_40", "tpS_80",
"twS_10", "twS_20", "twS_40", "twS_80",
"taS_10", "taS_20", "taS_40", "taS_80",
"deS_10", "deS_20", "deS_40", "deS_80",
"tpN_10", "tpN_20", "tpN_40", "tpN_80",
"twN_10", "twN_20", "twN_40", "twN_80",
"taN_10", "taN_20", "taN_40", "taN_80",
"deN_10", "deN_20", "deN_40", "deN_80",
"LDmeanS", "r2meanS", "LDmeanN", "r2meanN")
dataRow
}
r0 <- anaFun("000)
}
_
)
)))
r0 <- anaFun("000")
r0 <- anaFun("000")
anaFun <- function(repID){
gt2 <- read.gt(paste0(x = "~/temp/HRI/sim", repID, ".gt2"))
gt4 <- read.gt(paste0(x = "~/temp/HRI/sim", repID, ".gt4"))
samp2 <- lapply(c(10, 20, 40, 80), function(n) sampleGt(gt2, n))
samp4 <- lapply(c(10, 20, 40, 80), function(n) sampleGt(gt4, n))
sfs2 <- lapply(samp2, gt2sfs)
sfs4 <- lapply(samp4, gt2sfs)
tp2 <- sapply(sfs2, theta_pi, persite=T)
tw2 <- sapply(sfs2, theta_w, persite=T)
ta2 <- sapply(sfs2, tajd)
de2 <- sapply(sfs2, deltaTheta)
tp4 <- sapply(sfs4, theta_pi, persite=T)
tw4 <- sapply(sfs4, theta_w, persite=T)
ta4 <- sapply(sfs4, tajd)
de4 <- sapply(sfs4, deltaTheta)
LDmean2 <- meanN(pairwiseLD(gt2), 2500)
r2mean2 <- meanN(pairwiser2(gt2), 2500)
LDmean4 <- meanN(pairwiseLD(gt4), 2500)
r2mean4 <- meanN(pairwiser2(gt4), 2500)
#plot(pairwiseLD(gt2), pairwiser2(gt2))
dataRow <- c(tp2, tw2, ta2, de2,
tp4, tw4, ta4, de4,
LDmean2, r2mean2, LDmean4, r2mean4)
names(dataRow) <- c("tpS_10", "tpS_20", "tpS_40", "tpS_80",
"twS_10", "twS_20", "twS_40", "twS_80",
"taS_10", "taS_20", "taS_40", "taS_80",
"deS_10", "deS_20", "deS_40", "deS_80",
"tpN_10", "tpN_20", "tpN_40", "tpN_80",
"twN_10", "twN_20", "twN_40", "twN_80",
"taN_10", "taN_20", "taN_40", "taN_80",
"deN_10", "deN_20", "deN_40", "deN_80",
"LDmeanS", "r2meanS", "LDmeanN", "r2meanN")
dataRow
}
r0 <- anaFun("000")
r0
sprintf("%03d", 0)
a <- sapply(0:10, function(x) anaFun(sprintf("%03d", x)))
a <- sapply(1:10, function(x) anaFun(sprintf("%04d", x)))
a
as.data.frame(t(a))
b <- as.data.frame(t(a))
boxplot(b[,1:4])
names(b)
boxplot(b[,33:36])
library(parallel)
a <- mclapply(1:10, function(x) anaFun(sprintf("%04d", x)), mc.cores = 8)
do.call(rbind, a)
as.data.frame(do.call(rbind, a))
b <- as.data.frame(do.call(rbind, a))
boxplot(b[,1:4])
names(b)
boxplot(b[,33:36])
pairwiser <- function(gt){
gts <- gt[apply(gt, 1, sd) != 0,]
as.vector(cor(t(gts))[lower.tri(matrix(0,nrow(gts),nrow(gts)))])
}
anaFun <- function(repID){
gt2 <- read.gt(paste0(x = "~/temp/HRI/sim", repID, ".gt2"))
gt4 <- read.gt(paste0(x = "~/temp/HRI/sim", repID, ".gt4"))
samp2 <- lapply(c(10, 20, 40, 80), function(n) sampleGt(gt2, n))
samp4 <- lapply(c(10, 20, 40, 80), function(n) sampleGt(gt4, n))
sfs2 <- lapply(samp2, gt2sfs)
sfs4 <- lapply(samp4, gt2sfs)
tp2 <- sapply(sfs2, theta_pi, persite=T)
tw2 <- sapply(sfs2, theta_w, persite=T)
ta2 <- sapply(sfs2, tajd)
de2 <- sapply(sfs2, deltaTheta)
tp4 <- sapply(sfs4, theta_pi, persite=T)
tw4 <- sapply(sfs4, theta_w, persite=T)
ta4 <- sapply(sfs4, tajd)
de4 <- sapply(sfs4, deltaTheta)
LDmean2 <- meanN(pairwiseLD(gt2), 2500)
rmean2 <- meanN(pairwiser(gt2), 2500)
LDmean4 <- meanN(pairwiseLD(gt4), 2500)
rmean4 <- meanN(pairwiser(gt4), 2500)
#plot(pairwiseLD(gt2), pairwiser2(gt2))
dataRow <- c(tp2, tw2, ta2, de2,
tp4, tw4, ta4, de4,
LDmean2, rmean2, LDmean4, rmean4)
names(dataRow) <- c("tpS_10", "tpS_20", "tpS_40", "tpS_80",
"twS_10", "twS_20", "twS_40", "twS_80",
"taS_10", "taS_20", "taS_40", "taS_80",
"deS_10", "deS_20", "deS_40", "deS_80",
"tpN_10", "tpN_20", "tpN_40", "tpN_80",
"twN_10", "twN_20", "twN_40", "twN_80",
"taN_10", "taN_20", "taN_40", "taN_80",
"deN_10", "deN_20", "deN_40", "deN_80",
"LDmeanS", "rmeanS", "LDmeanN", "rmeanN")
dataRow
}
a <- mclapply(1:10, function(x) anaFun(sprintf("%04d", x)), mc.cores = 8)
b <- as.data.frame(do.call(rbind, a))
boxplot(b[,1:4])
names(b)
boxplot(b[,33:36])
qnorm(0.025)
meanSE <- function(vec){
m <- mean(vec)
se <- sd(vec) / sqrt(length(vec))
c(mean=m, lo = m - qnorm(0.025)*se, hi = m + qnorm(0.025)*se)
}
meanSE(b[,1])
apply(b, 2, meanSE)
a <- mclapply(1:100, function(x) anaFun(sprintf("%04d", x)), mc.cores = 10)
b <- as.data.frame(do.call(rbind, a))
boxplot(b[,1:4])
names(b)
boxplot(b[,33:36])
meanSE <- function(vec){
m <- mean(vec)
se <- sd(vec) / sqrt(length(vec))
c(mean=m, lo = m - qnorm(0.025)*se, hi = m + qnorm(0.025)*se)
}
apply(b, 2, meanSE)
anaFun <- function(repID, l=2500){
gt2 <- read.gt(paste0(x = "~/temp/HRI/sim", repID, ".gt2"))
gt4 <- read.gt(paste0(x = "~/temp/HRI/sim", repID, ".gt4"))
samp2 <- lapply(c(10, 20, 40, 80), function(n) sampleGt(gt2, n))
samp4 <- lapply(c(10, 20, 40, 80), function(n) sampleGt(gt4, n))
sfs2 <- lapply(samp2, gt2sfs)
sfs4 <- lapply(samp4, gt2sfs)
tp2 <- sapply(sfs2, theta_pi, persite=F)/l
tw2 <- sapply(sfs2, theta_w, persite=F)/l
ta2 <- sapply(sfs2, tajd)
de2 <- sapply(sfs2, deltaTheta)
tp4 <- sapply(sfs4, theta_pi, persite=F)/l
tw4 <- sapply(sfs4, theta_w, persite=F)/l
ta4 <- sapply(sfs4, tajd)
de4 <- sapply(sfs4, deltaTheta)
LDmean2 <- meanN(pairwiseLD(gt2), l)
rmean2 <- meanN(pairwiser(gt2), l)
LDmean4 <- meanN(pairwiseLD(gt4), l)
rmean4 <- meanN(pairwiser(gt4), l)
#plot(pairwiseLD(gt2), pairwiser2(gt2))
dataRow <- c(tp2, tw2, ta2, de2,
tp4, tw4, ta4, de4,
LDmean2, rmean2, LDmean4, rmean4)
names(dataRow) <- c("tpS_10", "tpS_20", "tpS_40", "tpS_80",
"twS_10", "twS_20", "twS_40", "twS_80",
"taS_10", "taS_20", "taS_40", "taS_80",
"deS_10", "deS_20", "deS_40", "deS_80",
"tpN_10", "tpN_20", "tpN_40", "tpN_80",
"twN_10", "twN_20", "twN_40", "twN_80",
"taN_10", "taN_20", "taN_40", "taN_80",
"deN_10", "deN_20", "deN_40", "deN_80",
"LDmeanS", "rmeanS", "LDmeanN", "rmeanN")
dataRow
}
r0 <- anaFun("000")
r0 <- anaFun("0001")
r0
a <- mclapply(1:100, function(x) anaFun(sprintf("%04d", x)), mc.cores = 10)
b <- as.data.frame(do.call(rbind, a))
boxplot(b[,1:4])
boxplot(b[,33:36])
meanSE <- function(vec){
m <- mean(vec)
se <- sd(vec) / sqrt(length(vec))
c(mean=m, lo = m - qnorm(0.025)*se, hi = m + qnorm(0.025)*se)
}
meanSE(b[,1])
apply(b, 2, meanSE)
anaFun <- function(repID, l=2500){
gt2 <- read.gt(paste0(x = "~/temp/HRI/sim", repID, ".gt2"))
gt4 <- read.gt(paste0(x = "~/temp/HRI/sim", repID, ".gt4"))
samp2 <- lapply(c(10, 20, 40, 80), function(n) sampleGt(gt2, n))
samp4 <- lapply(c(10, 20, 40, 80), function(n) sampleGt(gt4, n))
sfs2 <- lapply(samp2, gt2sfs)
sfs4 <- lapply(samp4, gt2sfs)
tp2 <- sapply(sfs2, theta_pi, persite=F)/l
tw2 <- sapply(sfs2, theta_w, persite=F)/l
ta2 <- sapply(sfs2, tajd)
de2 <- sapply(sfs2, deltaTheta)
tp4 <- sapply(sfs4, theta_pi, persite=F)/l
tw4 <- sapply(sfs4, theta_w, persite=F)/l
ta4 <- sapply(sfs4, tajd)
de4 <- sapply(sfs4, deltaTheta)
LDmean2 <- meanN(pairwiseLD(gt2), l*(l-1)/2)
rmean2 <- meanN(pairwiser(gt2), l*(l-1)/2)
LDmean4 <- meanN(pairwiseLD(gt4), l*(l-1)/2)
rmean4 <- meanN(pairwiser(gt4), l*(l-1)/2)
#plot(pairwiseLD(gt2), pairwiser2(gt2))
dataRow <- c(tp2, tw2, ta2, de2,
tp4, tw4, ta4, de4,
LDmean2, rmean2, LDmean4, rmean4)
names(dataRow) <- c("tpS_10", "tpS_20", "tpS_40", "tpS_80",
"twS_10", "twS_20", "twS_40", "twS_80",
"taS_10", "taS_20", "taS_40", "taS_80",
"deS_10", "deS_20", "deS_40", "deS_80",
"tpN_10", "tpN_20", "tpN_40", "tpN_80",
"twN_10", "twN_20", "twN_40", "twN_80",
"taN_10", "taN_20", "taN_40", "taN_80",
"deN_10", "deN_20", "deN_40", "deN_80",
"LDmeanS", "rmeanS", "LDmeanN", "rmeanN")
dataRow
}
a <- mclapply(1:100, function(x) anaFun(sprintf("%04d", x)), mc.cores = 10)
b <- as.data.frame(do.call(rbind, a))
boxplot(b[,33:36])
meanSE <- function(vec){
m <- mean(vec)
se <- sd(vec) / sqrt(length(vec))
c(mean=m, lo = m - qnorm(0.025)*se, hi = m + qnorm(0.025)*se)
}
apply(b, 2, meanSE)
t(apply(b, 2, meanSE))
t(apply(b, 2, meanSE))[1:29]
t(apply(b, 2, meanSE))[1:29,]
t(apply(b, 2, meanSE))[1:32,]
?cor
